---
title: "LLMãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰åˆ¶å¾¡ / LLM-Hybrid Control"
---

# ğŸ¤– Part 9: ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰åˆ¶å¾¡ã¨LLMçµ±åˆ  
*Part 9: Hybrid Control with LLM Integration*

---

## ğŸ”— å…¬å¼ãƒªãƒ³ã‚¯ | *Official Links*

| è¨€èª / Language | GitHub Pages ğŸŒ | GitHub ğŸ’» |
|-----------------|----------------|-----------|
| ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª / *Japanese* | [![GitHub Pages JP](https://img.shields.io/badge/GitHub%20Pages-æ—¥æœ¬èªç‰ˆ-brightgreen?logo=github)](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/) | [![GitHub Repo JP](https://img.shields.io/badge/GitHub-æ—¥æœ¬èªç‰ˆ-blue?logo=github)](https://github.com/Samizo-AITL/EduController/tree/main/part09_llm_hybrid) |

---

æœ¬ç« ã¯ **æ•™è‚²ãƒ»ç ”ç©¶ç”¨ã®æ§‹æƒ³æ®µéš** ã®å†…å®¹ã§ã™ã€‚  
*This chapter is at a **conceptual / research stage**.*  

- **å®‰å®šæ€§ã¨å¿œç­”è¨­è¨ˆã¯PIDç­‰ã®åˆ¶å¾¡ç†è«–ã«åŸºã¥ã**ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚  
  *Stability and response design rely on classical control theory (e.g., PID).*  
- **FSMã‚„LLMã¯å¤–å±¤ã®ç›£ç£ãƒ»æ”¯æ´å±¤**ã§ã‚ã‚Šã€ç›´æ¥çš„ãªå®‰å®šæ€§ä¿è¨¼ã®å¯¾è±¡ã«ã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚  
  *FSM and LLM act as outer supervisory / support layers, not part of the stability-guaranteed control loop.*  
- é‹è»¢ä¸­ã®å®‰å®šæ€§ã¯ **PIDãƒ«ãƒ¼ãƒ—ã§æ‹…ä¿**ã—ã€LLMå‡ºåŠ›ã¯ç›£ç£ä¸‹ã§ã®ã¿é©ç”¨ã—ã¾ã™ï¼ˆLLMã¯åˆ¶å¾¡ãƒ«ãƒ¼ãƒ—ã«ç›´æ¥ä»‹å…¥ã—ã¾ã›ã‚“ï¼‰ã€‚  
  *Stability is guaranteed by the PID loop; LLM proposals are applied only under supervision and never run inside the real-time loop.*  
- è¨˜è¿°å†…å®¹ã¯PoCã‚„æ•™è‚²å®Ÿé¨“ã®ä¸€éƒ¨ã§ã‚ã‚Šã€ä»Šå¾Œã®æ¤œè¨¼ã§å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚  
  *Contents are PoC / educational experiments and may change with further validation.*

---

## ğŸ¯ **å­¦ç¿’ç›®æ¨™ / Learning Objectives**

- **FSMã¨PIDåˆ¶å¾¡**ã®é€£æºæ‰‹æ³•ã‚’ç†è§£ã™ã‚‹  
  *Understand how to integrate FSM with PID control*  
- **LLMï¼ˆChatGPTç­‰ï¼‰ã‚’åˆ¶å¾¡åˆ¤æ–­ã«æ´»ç”¨**ã™ã‚‹æ‰‹æ³•ã‚’å­¦ã¶  
  *Learn how to utilize LLMs (e.g., ChatGPT) for control decision-making*  
- **ãƒ«ãƒ¼ãƒ«ãƒ»å¯¾è©±ãƒ™ãƒ¼ã‚¹ã®åˆ¶å¾¡æˆ¦ç•¥**ã‚’è¨­è¨ˆã§ãã‚‹  
  *Design rule-based and dialogue-based control strategies*  
- **ç•°å¸¸å¯¾å¿œãƒ»ç›®çš„æ¨è«–ãƒ»ã‚·ãƒŠãƒªã‚ªåˆ¶å¾¡**ã‚’ä½“é¨“ã™ã‚‹  
  *Experience exception handling, goal reasoning, and scenario control*  
- **AITLä¸‰å±¤æ§‹é€ ã«ã‚ˆã‚‹PoCå®Ÿè£…**ã‚’è¡Œã†  
  *Implement a PoC of the three-layer AITL architecture*  

---

## ğŸ§© **ç« æ§‹æˆï¼ˆç†è«–æ•™æï¼‰/ Chapter Structure (Theory)**

| **ãƒ•ã‚¡ã‚¤ãƒ« / File** | **å†…å®¹ / Description** |
|---------------------|-------------------------|
| [01_fsm_pid_llm.md](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/theory/01_fsm_pid_llm.html) | FSMãƒ»PIDãƒ»LLMã«ã‚ˆã‚‹ä¸‰å±¤åˆ¶å¾¡æ§‹é€ ã®å…¨ä½“åƒ <br>*Overview of FSM Ã— PID Ã— LLM architecture* |
| [02_scenario_control.md](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/theory/02_scenario_control.html) | ã‚·ãƒŠãƒªã‚ªåˆ¶å¾¡ã¨çŠ¶æ…‹ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ã®è¨­è¨ˆ <br>*Scenario-based control and state switching design* |
| [03_exception_handling.md](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/theory/03_exception_handling.html) | LLMã‚’ç”¨ã„ãŸç•°å¸¸æ¤œå‡ºã¨ä¾‹å¤–å¯¾å¿œ <br>*LLM-based anomaly detection and exception handling* |
| [04_goal_reasoning.md](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/theory/04_goal_reasoning.html) | ç›®çš„æ¨è«–ã¨å¯¾è©±å‹åˆ¶å¾¡ã®å°å…¥ <br>*Introduction to goal reasoning and dialogue-based control* |

---

## ğŸ§ª **å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã¨Notebook / Simulation Code & Notebooks**

| **ãƒ•ã‚¡ã‚¤ãƒ« / File** | **å½¹å‰² / Function** |
|----------------------|----------------------|
| [fsm_pid_llm_sim.py](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/simulation/fsm_pid_llm_sim.py) | ä¸‰å±¤åˆ¶å¾¡çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆFSM Ã— PID Ã— LLMï¼‰ <br>*Integrated simulation of FSM Ã— PID Ã— LLM* |
| [goal_reasoning_agent.py](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/simulation/goal_reasoning_agent.py) | LLMãƒ™ãƒ¼ã‚¹ã®ç›®çš„æ¨è«–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¯ãƒ©ã‚¹ <br>*LLM-based goal reasoning agent* |
| [hybrid_control_demo.ipynb](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/notebooks/hybrid_control_demo.ipynb) | Notebookå¯è¦–åŒ–ãƒ‡ãƒ¢ï¼ˆäºˆå®šï¼‰ <br>*Planned notebook visualization demo* |

> ğŸ’¡ **ç‰¹é•· / Highlights**  
> - ã‚»ãƒ³ã‚µå…¥åŠ›ã€PIDåˆ¶å¾¡ã€FSMé·ç§»ã€LLMå‡ºåŠ›ã‚’å¯è¦–åŒ–å¯èƒ½  
>   *Visualization of sensor input, PID control, FSM transitions, and LLM output*  
> - å°ã•ãªã‚³ãƒ¼ãƒ‰æ”¹å¤‰ã‹ã‚‰ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“è¨­è¨ˆã¾ã§æ®µéšçš„ã«å­¦ã¹ã‚‹  
>   *Supports progressive learning, from small code changes to full system design*  
> - LLMã«ã‚ˆã‚‹å¯¾è©±å¿œç­”ä¾‹ã‚„æ„å›³æ¨è«–ãƒ­ã‚°ã‚’ç¢ºèªã§ãã‚‹  
>   *Check dialogue examples and intent reasoning logs generated by LLMs*  

---

## ğŸ“˜ **ç« ã¨å®Ÿè£…å¯¾å¿œè¡¨ / Mapping Between Theory and Code**

| **æ•™æç«  / Section** | **å†…å®¹ / Topic** | **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« / Script** | **å‚™è€ƒ / Notes** |
|------------------|------------------|-----------------------------|------------------|
| ç¬¬1ç«  | FSMãƒ»PIDãƒ»LLMçµ±åˆ <br>*FSM, PID, and LLM integration* | `fsm_pid_llm_sim.py` | çŠ¶æ…‹é·ç§»ï¼‹PIDï¼‹LLM ã®PoC <br>*State transitions + PID + LLM PoC* |
| ç¬¬2ç«  | ã‚·ãƒŠãƒªã‚ªåˆ¶å¾¡ <br>*Scenario control* | `fsm_pid_llm_sim.py` | FSMã«åŸºã¥ããƒ¢ãƒ¼ãƒ‰ç®¡ç† <br>*Mode management based on FSM* |
| ç¬¬3ç«  | ä¾‹å¤–å‡¦ç† <br>*Exception handling* | LLMãƒ­ã‚°å‡ºåŠ›éƒ¨ | çŠ¶æ³åˆ¤æ–­ãƒ»åˆ‡æ›¿ãƒ­ã‚¸ãƒƒã‚¯ <br>*Context judgment and switching logic* |
| ç¬¬4ç«  | ç›®çš„æ¨è«–åˆ¶å¾¡ <br>*Goal reasoning control* | `goal_reasoning_agent.py` | è‡ªå¾‹çš„æ„æ€æ±ºå®šã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ <br>*Simulation of autonomous decision-making* |

---

## ğŸ§  **LLMã®æœ€å°ç†å±ˆã¨åˆ©ç”¨å½¢æ…‹ / Minimal Logic and Usage of LLMs**

- **Attention**ï¼šéå»æƒ…å ±ã‚’å‹•çš„ã«é‡ã¿ä»˜ã‘ â†’ PIDã®å›ºå®šã‚²ã‚¤ãƒ³ã¨å¯¾æ¯”ã—ã¦æŸ”è»Ÿæ€§ã‚’æ‹¡å¼µ  
  *Attention dynamically weights past information â†’ comparable to extending fixed PID gains*  
- **æ½œåœ¨è¡¨ç¾**ï¼šå†…éƒ¨ãƒ™ã‚¯ãƒˆãƒ«ã¯çŠ¶æ…‹ç©ºé–“è¿‘ä¼¼ã¨è¦‹ãªã›ã‚‹  
  *Latent representations approximate system state space*  
- **ç¢ºç‡çš„å‡ºåŠ›**ï¼šåˆ†å¸ƒã¨ã—ã¦äºˆæ¸¬ â†’ è¡Œå‹•å€™è£œåˆ†å¸ƒã«å¯¾å¿œ  
  *Probabilistic outputs correspond to candidate action distributions*  

**åˆ†é¡ / Types**  
- ã‚¯ãƒ©ã‚¦ãƒ‰å‹ï¼ˆChatGPT ç­‰ï¼‰ï¼šè¨­è¨ˆæ”¯æ´ãƒ»è‡ªç„¶è¨€èªã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹å‘ã  
  *Cloud-based (e.g., ChatGPT): suitable for design support and natural language interface*  
- çµ„ã¿è¾¼ã¿å‹ï¼ˆLLaMA, Phi, Mistral ç­‰ï¼‰ï¼šåˆ¶å¾¡ãƒ«ãƒ¼ãƒ—å†…ã«çµ±åˆå¯èƒ½  
  *Embedded (e.g., LLaMA, Phi, Mistral): integrable into control loops*  

ğŸ‘‰ FSMã‚„PIDã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ **å®‰å®šæ€§ï¼‹æŸ”è»Ÿæ€§** ã‚’ä¸¡ç«‹ã§ãã‚‹ã€‚  
*Combining FSM and PID ensures stability while extending flexibility.*  

---

## ğŸ”— **ä¸‰å±¤çµ±åˆåˆ¶å¾¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆæ¦‚å¿µå›³ï¼‰ / Three-Layer Integrated Control Architecture**

```mermaid
graph TD
  S[ã‚»ãƒ³ã‚µå…¥åŠ› / Sensor Data] --> P[PIDåˆ¶å¾¡ / PID Control]
  S --> F[FSMçŠ¶æ…‹é·ç§» / FSM Transition]
  S --> L[LLMï¼ˆæ¨è«–å™¨ï¼‰ / LLM Inference]

  P --> U[åˆ¶å¾¡å…¥åŠ› / Control Signal]
  F --> U
  L --> U

  U --> A[ã‚¢ã‚¯ãƒãƒ¥ã‚¨ãƒ¼ã‚¿ / Actuator]
```

---

## ğŸ“‘ **Appendix / Expert Notes**

- [appendix_expert.md](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/appendix_expert.html)  
  *å°‚é–€å®¶å‘ã‘è£œè¶³è³‡æ–™ã€‚åˆ¶å¾¡å·¥å­¦ã¨AIã®æ¥ç‚¹ã‚’ã‚ˆã‚Šæ·±æ˜ã‚Šã—ãŸè§£èª¬ã€‚*  
  *Expert supplement: deeper exploration of control engineering Ã— AI integration.*

---

## ğŸ›  **å®Ÿè¡Œç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ« / Execution Environment Files**

- [requirements.txt](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/requirements.txt)  
  *å¿…è¦æœ€å°é™ã®ä¾å­˜é–¢ä¿‚ / Minimal dependencies*  
- [Makefile](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/Makefile)  
  *ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒ‡ãƒ¢å®Ÿè¡Œç”¨ã‚³ãƒãƒ³ãƒ‰ / Commands for running simulations and demos*  
- [.gitignore](https://samizo-aitl.github.io/EduController/part09_llm_hybrid/.gitignore)  
  *ä¸è¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰é™¤å¤– / Ignore unnecessary files*

---

## ğŸ”œ **ä»Šå¾Œã®å±•é–‹ / Next Steps**

- ChatGPT API ã¨å®Ÿæ©Ÿåˆ¶å¾¡ã®æ¤œè¨¼  
  *Verification of real-machine control with ChatGPT API*  
- ãƒ­ãƒœãƒƒãƒˆï¼GUIï¼éŸ³å£°å¯¾è©±ã«ã‚ˆã‚‹ã‚·ãƒŠãƒªã‚ªåˆ¶å¾¡  
  *Scenario control with robots, GUI, and voice interaction*  
- å¼·åŒ–å­¦ç¿’ã¨ã®çµ±åˆã«ã‚ˆã‚‹è‡ªå·±é©å¿œåˆ¶å¾¡ï¼ˆPart 10 äºˆå®šï¼‰  
  *Integration with reinforcement learning for self-adaptive control (Planned in Part 10)*  

---

## ğŸ”— é–¢é€£ç« ãƒªãƒ³ã‚¯ / Related Chapters

- [2.6 FSMå°å…¥ã¨çŠ¶æ…‹åˆ¶å¾¡ã®åŸºæœ¬ (Edusemi-v4x)](https://samizo-aitl.github.io/Edusemi-v4x/chapter2_comb_logic/2.6_fsm_intro.html)  
  *Introduction to FSM and state control basics*  
- [ç¬¬8ç«  FSMè¨­è¨ˆ (Edusemi-v4x)](https://samizo-aitl.github.io/Edusemi-v4x/d_chapter8_fsm_design_basics/)  
  *Chapter 8: FSM Design*  
- [01 PIDåˆ¶å¾¡ã®åŸºç¤ (EduController)](../part01_classical/theory/01_pid_control.md)  
  *01 Basics of PID Control*  

---

## ğŸ“š **å‚è€ƒè³‡æ–™ / References**

- OpenAI ChatGPT: <https://platform.openai.com/>  
- EduController (GitHub): <https://github.com/Samizo-AITL/EduController>  
- FSM/PID/LLM ã®çµ±åˆæ§‹æƒ³ï¼šAITLæ§‹æƒ³ï¼ˆAITL-Hï¼‰  
  *Integration concept of FSM/PID/LLM: AITL framework (AITL-H)*  

---

## ğŸ‘¤ **è‘—è€…ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ | Author & License**

| ğŸ“Œ é …ç›® / Item | ğŸ“„ å†…å®¹ / Details |
|------|------|
| **è‘—è€… / Author** | **ä¸‰æº çœŸä¸€**ï¼ˆShinichi Samizoï¼‰ <br>*Shinichi Samizo* |
| **ğŸ’» GitHub** | [![GitHub](https://img.shields.io/badge/GitHub-Samizo--AITL-blue?style=for-the-badge&logo=github)](https://github.com/Samizo-AITL) |

---

## ğŸ“„ **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ / License**

[![Hybrid License](https://img.shields.io/badge/license-Hybrid-blueviolet)](#-ãƒ©ã‚¤ã‚»ãƒ³ã‚¹--license)  

> æ•™æãƒ»ã‚³ãƒ¼ãƒ‰ãƒ»å›³è¡¨ã®æ€§è³ªã«å¿œã˜ãŸãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’æ¡ç”¨ã€‚  
> *Hybrid licensing based on the nature of the materials, code, and diagrams.*

| ğŸ“Œ é …ç›® / Item | ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ / License | èª¬æ˜ / Description |
|------|------|------|
| **ã‚³ãƒ¼ãƒ‰ï¼ˆCodeï¼‰** | [MIT License](https://opensource.org/licenses/MIT) | è‡ªç”±ã«ä½¿ç”¨ãƒ»æ”¹å¤‰ãƒ»å†é…å¸ƒãŒå¯èƒ½ <br>*Free to use, modify, and redistribute* |
| **æ•™æãƒ†ã‚­ã‚¹ãƒˆï¼ˆText materialsï¼‰** | [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/) | è‘—è€…è¡¨ç¤ºå¿…é ˆ <br>*Attribution required* |
| **å›³è¡¨ãƒ»ã‚¤ãƒ©ã‚¹ãƒˆï¼ˆFigures & diagramsï¼‰** | [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/) | éå•†ç”¨åˆ©ç”¨ã®ã¿è¨±å¯ <br>*Non-commercial use only* |
| **å¤–éƒ¨å¼•ç”¨ï¼ˆExternal referencesï¼‰** | å…ƒãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«å¾“ã† <br>*Follow the original license* | å¼•ç”¨å…ƒã‚’æ˜è¨˜ <br>*Cite the original source* |

---

**â¬…ï¸ [å‰ç«  / Previous Chapter](../part08_data_driven/index.md)**  
**[æ¬¡ç«  / Next Chapter â¡ï¸â¡ï¸](../part10_pendulum/index.md)**  
**ğŸ  [ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ / Back to Home](../index.md)**






